name: Reusable Workflow user

on:
  workflow_dispatch:

jobs:

  getfolders:
    runs-on: ubuntu-latest
    outputs:
      dirs: ${{ steps.dirs.outputs.test }}

    steps:
        - uses: actions/checkout@v3
        - id: dirs
          run: |
            git diff --name-only HEAD~1 | awk -F "/*[^/]*/*$" '{ print ($1 == "" ? "." : $1); }' | sort | uniq
    

  docker:
      needs: getfolders
      uses: codeandmedia/A/.github/workflows/main.yml@main
      with:
        image_tag: ${{ github.ref_name }}
        folder: ${{needs.getfolders.outputs.dirs}}
